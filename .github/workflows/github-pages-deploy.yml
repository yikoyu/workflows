name: Github Pages deploy

on:
  workflow_call:
    inputs:
      build-command:
        required: false
        type: string
        default: npm run build

      folder:
        description: The folder in your repository that you want to deploy. If your build script compiles into a directory named build you would put it here. Folder paths cannot have a leading / or ./. If you wish to deploy the root directory you can place a . here.
        required: false
        type: string
        default: dist

      branch:
        description: 'This is the branch you wish to deploy to, for example gh-pages or docs.'
        required: false
        type: string
        default: gh-pages

      target-folder:
        description: If you would like to push the contents of the deployment folder into a specific directory on the deployment branch you can specify it here.
        required: false
        type: string

      clean:
        description: If your project generates hashed files on build you can use this option to automatically delete them from the target folder on the deployment branch with each deploy. This option is on by default and can be toggled off by setting it to false.
        required: false
        type: boolean
        default: true

      clean-exclude:
        description: If you need to use clean but you would like to preserve certain files or folders you can use this option. This should contain each pattern as a single line in a multiline string.
        required: false
        type: string

jobs:
  deploy:
    runs-on: [ubuntu-latest]

    permissions:
      contents: write

    steps:
      - name: Setup JS
        uses: yikoyu/workflows/setup-js@main

      - name: Build
        shell: bash
        run: ${{ inputs.build-command }}

      - name: éƒ¨ç½²åˆ° GH-Pages ðŸš€
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: ${{ inputs.folder }}
          branch: ${{ inputs.branch }}
          single-commit: true
          target-folder: ${{ inputs.target-folder }}
          clean: ${{ inputs.clean }}
          clean-exclude: ${{ inputs.clean-exclude }}
          commit-message: 'chore(gh-pages): deploy ${{ github.ref_name }} branch @ ${{ github.sha }}'
